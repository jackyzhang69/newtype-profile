{
  "workflow_id": "work_risk_audit",
  "name": "Complete Work Permit Risk Audit",
  "description": "Full audit workflow for work permit applications with all agents and verification stages",
  "app_type": "work",
  "version": "1.0.0",
  "stages": [
    {
      "id": "intake",
      "agent": "intake",
      "description": "Extract and normalize application documents",
      "required": true,
      "depends_on": [],
      "retry_limit": 2,
      "timeout_seconds": 300
    },
    {
      "id": "detective",
      "agent": "detective",
      "description": "Research case law and policy via MCP services",
      "required": true,
      "depends_on": ["intake"],
      "retry_limit": 2,
      "timeout_seconds": 600
    },
    {
      "id": "strategist",
      "agent": "strategist",
      "description": "Assess risks and create defense strategy",
      "required": true,
      "depends_on": ["detective"],
      "retry_limit": 2,
      "timeout_seconds": 600
    },
    {
      "id": "gatekeeper",
      "agent": "gatekeeper",
      "description": "Validate compliance and identify refusal triggers",
      "required": true,
      "depends_on": ["strategist"],
      "retry_limit": 2,
      "timeout_seconds": 300
    },
    {
      "id": "verifier",
      "agent": "verifier",
      "description": "Verify citation accuracy and case law validity",
      "required": false,
      "depends_on": ["gatekeeper"],
      "retry_limit": 3,
      "timeout_seconds": 300,
      "tier_availability": ["pro", "ultra"]
    },
    {
      "id": "judge",
      "agent": "judge",
      "description": "Make final verdict (GO/CAUTION/NO-GO)",
      "required": false,
      "depends_on": ["verifier"],
      "retry_limit": 1,
      "timeout_seconds": 300,
      "only_in": ["risk_audit", "initial_assessment", "final_review", "refusal_analysis"]
    },
    {
      "id": "reporter",
      "agent": "reporter",
      "description": "Generate final audit report with recommendations",
      "required": true,
      "depends_on": ["judge"],
      "retry_limit": 1,
      "timeout_seconds": 300
    }
  ],
  "metadata": {
    "created": "2026-01-27",
    "audit_tier_compatibility": ["guest", "pro", "ultra"],
    "estimated_duration_minutes": 60,
    "description_full": "Complete risk audit for work permit applications. Includes full case law research, risk assessment, compliance validation, citation verification, verdict, and final reporting."
  }
}
